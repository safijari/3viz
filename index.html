<!DOCTYPE html>
<html>
	  <head>
		    <title>My first three.js app</title>
		    <style>
			   body { margin: 0; }
			   canvas { width: 100%; height: 100% }
		    </style>
	  </head>

		<style>
		 body {
				 background-color: #f0f0f0;
				 color: #444;
		 }
		 a {
				 color: #08f;
		 }
		</style>

	  <body>
		    <script src="js/three.js"></script>
		    <script src="js/OrbitControls.js"></script>
        <script src="helpers.js"/></script>

		    <script>


         var host = window.location.host;
         /* var ws = new WebSocket('ws://'+host+'/ws'); */
         var ws = new WebSocket('ws://localhost:8888/ws');

         ws.onopen = function(){
             console.log("websocket opened");
         };

         ws.onclose = function(ev){
             console.log(ev);
             console.log("websocket closed");
         };

         ws.onerror = function(ev){
             console.log("websocket errored");
         };

         var scn = make_scene(window)

			   document.body.appendChild( scn.renderer.domElement );
			   scn.camera.position.z = 5;
			   scn.camera.position.y = -5;
			   scn.camera.position.x = -5;

         add_axes(scn, 0.5, "root", mkpos(0, 0, 0));

         function animate() {
	           requestAnimationFrame( animate );
	           scn.controls.update();
				     render_scene(scn);
         }

         ws.onmessage = function(ev){
             data = JSON.parse(ev.data);
             if (data.type == "axes") {
                 add_axes(scn, data.size, data.label, data.position, data.orientation);
             }
             else if (data.type == "axes_list") {
                 for (var i = 0; i < data.elements.length; i++) {
                     var el = data.elements[i];
                     add_axes(scn, el.size, el.label, el.position, el.orientation);
                 }
             }
         };

         animate();

		    </script>
	  </body>
</html>
